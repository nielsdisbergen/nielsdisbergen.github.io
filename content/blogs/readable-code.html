<!DOCTYPE html>

<html lang="en">


<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  <title> Niels R. Disbergen - Blog </title>

  <!-- CSS  Loc, Dist -->
  <link href="../../css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="../../css/style.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="../../css/prettify/tomorrow-night-eighties.css" type="text/css" rel="stylesheet" />

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">

</head>

<body onload="prettyPrint()">

  <nav class="mintgreen" role="navigation">

    <ul id="code-dev-dsk" class="dropdown-content">
      <li><a href="../projects.html">Projects</a></li>
      <li><a href="../snippets.html">Snippets</a></li>
      <li><a href="../code/misc-code.html">Misc</a></li>
      <li><a href="http://github.com/nielsdisbergen">GitHub<i class="fa fa-github" style="font-size:28px;color:teal"></i></a></li>
    </ul>

    <ul id="code-dev-mob" class="dropdown-content">
      <li><a href="../projects.html">Projects</a></li>
      <li><a href="../snippets.html">Snippets</a></li>
      <li><a href="../code/misc-code.html">Misc</a></li>
      <li><a href="http://github.com/nielsdisbergen">GitHub</a></li>
    </ul>

    <div class="nav-wrapper container">

      <a class="white-text" href="../../index.html"><i class="material-icons left" style="font-size:25px">account_balance</i></a>
      <a class="white-text" href="../../index.html">Niels R. Disbergen</a>

      <ul class="right hide-on-med-and-down">
        <li><a class="white-text" href="../about-me.html">About Me</a></li>
        <li><a class="white-text" href="../blog_main.html">Blog</a></li>
        <li><a class="white-text" href="../publications_main.html">Publications</a></li>
        <li><a class="white-text dropdown-button" href="#" data-activates="code-dev-dsk">Codes<i class="material-icons right">arrow_drop_down</i></a></li>
        <li><a class="white-text" href="../links.html">Links</a></li>
        <li><a class="white-text" href="../contact.html">Contact</a></li>
      </ul>

      <ul id="nav-mobile" class="side-nav teal">
        <li><a class="white-text" href="../about-me.html">About Me</a></li>
        <li><a class="white-text" href="../blog_main.html">Blog</a></li>
        <li><a class="white-text" href="../publications_main.html">Publications</a></li>
        <li><a class="white-text dropdown-button" href="#" data-activates="code-dev-mob">Codes<i class="material-icons right">arrow_drop_down</i></a></li>
        <li><a class="white-text" href="../links.html">Links</a></li>
        <li><a class="white-text" href="../contact.html">Contact</a></li>
      </ul>

      <a href="#" data-activates="nav-mobile" class="button-collapse white-text"><i class="material-icons" style="font-size:24px;">menu</i></a>

    </div>
  </nav>

  <div class="container">
    <div class="section">

      <div class="left">
        <h3 class="brown-text left">Writing Readable and Well Formatted Code - Why Bother?</h3>
      </div>

      <div class="row">

        <div class="col s12 left">
          <h6 class="brown-text left" style="font-size:9pt"><em>Posted 24 August 2018</em></h6>
          <br><br>

          <p>[Below text is still under development]</p>

          <p>This is the first post in what will, hopefully, become a series tapping into what I believe are very important attributes of well written and maintainable (scientific) code. This first post will be the introduction of a series of several, focussing on the, relatively controversial among some, and often polarizing, topic of code formatting and commenting, <i>id est</i> code readability. Even though the term code readability, which I strongly believe is a great attribute for both others and your future self, entails several broader coding concepts, we will start of by looking into formatting and commenting, returning to other topics later on. And yes, almost all of these discussions apply to all of you scripting-only/loving folks out there as well.</p><br>

          <h4 class="brown-text">Introduction</h4>
          <p>Before diving in head-deep and burning my fingers, I wanted to share a few typical responses to the mention of this topic I have encountered on multiple occasions:
          <ul style="list-style-type:none">
            <li>"<i>It takes too much time to do all this [formatting and commenting], I better use it to perform other tasks</i>"</li><br>

            <li>"<i>These things are not important, what matters is that it works, if others want to understand my code they should just go through it line by line and figure out themselves what it does</i>"</li><br>

            <li>"<i>I am not a computer engineer, so why bother, this is not my job</i>"</li>
          </ul>
          </p>

          <p>Across these post I will mostly make use of examples in Matlab which are specifically tailored for Neuroscientist, even though this logic applies to most languages and other problems out there. Many of the items are simplifications of larger problems, where, for example, the of use a for-loop with an incrementing counter is necessary, hence examples will appear where it is possible to solve the small-scale simplification discussed here with another (possibly more simplistic) counter-structure. These examples are mostly based on encounters in my work as a code-loving neuroscientist, hence I try to apply examples drawn from common issues there, hopefully allowing pears to apply them in situations where very often the large-scale problem requires the incrementing counter structure. The same applies to a possible over-use of for-loop structures.</p>

          <p>One of the more important concepts is that when there is <i>no organization</i> in your head, it will be very hard to get organization in your code. A good concept to keep in the back of your head is, 'Think twice, code once'.</p>

          <p>On that note, I am convinced that old-fashioned pen and pencil exercises (or their digital equivalent) along with drawings are a necessity to work out code problems, resulting in more thought-through end-results. Another one of my favorite approaches, though slightly more radical, is to delete all your code once you finished a limited-scale block and re-write it from scratch; I have never encountered a situation in which this did not lead to a cleaner (and often faster) end result. For many coding tasks the main job at hand is solving the problem, once it has been solved (through coding) you have the answer in mind, which will allow you to write a cleaner/better implementation leading to the same end-result.</p>
          <br>

          <h5><i>[Further text to be inserted]</i></h5>
          <br>

          <h4 class="brown-text">Example</h4>
              <p>
              A simple script employing a time-series correlation analysis function <code>CorrelateTimeSeries()</code>, which is computed for a non-continuously numbered subset of subjects:
              <pre class="prettyprint lang-matlab" style="center-align">includedSubjects = [1 3 7];
nSubjects = length(includedSubjects);

correlateTimeSeriesIndividuals = nan(128, 128, nSubjects)
for indexSubject = 1:nSubjects
    dataFile{indexSubject, 1} = sprintf('S%i_DataFile.mat', indexSubject);
    correlatedTimeSeriesIndividuals(:, :, indexSubject) = CorrelateTimeSeries(dataFile{indexSubject, 1});
    % ...
    save(sprintf('%s_CorrTimeSeries.mat', dataFile{cntSubj, 1}(1:end-4)), correlatedTimeSeriesIndividuals);
end

if sum(isnan(correlateTimeSeriesIndividuals(:)) ~= 0)
  error('Variable "correlatedTimeSeriesIndividuals" contains NaN')
end</pre>
              Now looking at how this runs: when <code>indexSubject = 1</code>, dataFile{1,1} will evaluate to '<code>S1_DataFile.mat</code>', so far so good. Heading into the next iteration <code>indexSubject = 2</code>, dataFile{2,1} will evaluate to '<code>S2_DataFile.mat</code>', here some issue arises because subject <code>S2</code> is not included in the list: <code>includedSubjects = [1 3 7]</code>.<br><br>

              Overall, the main issues with this code are:
              <ol type="1">
              <li>Variable <code>dataFile</code> evaluates to incorrect file-names</li>
              <li>Loop-counter naming is not ideal</li>
              <li>Error throwing implementation can be improved</li>
              <li>Some comments would be good</li>
              </ol>

              Let us start by looking into #2: the counter-variable name <code>indSubject</code> indicated that we are dealing with an 'index' variable, which in the case discussed here is not per definition incorrect, though it does lead to some confusion. Index in this case could be referenced to the implementation of the variable as an index to store data in our matrix <code>correlatedTimeSeriesIndividuals</code>, but this is not the only task it performs. A better interpretation would be that this loop-counter gives me the subject's index, which in its current version is not the case, note that this would be correct if our subjects were a continuous incrementation (e.g. <code>[1 2 3]</code>). Even if this is the case, it would be best to choose another name in the light of code flexibility, we may not always include all subjects. A better name for this variable would be <code>counterSubject</code>, referencing that it counts over subjects and hence is the index by which you extract the subject being analyzed from the subject-vector <code>includedSubjects</code>. When we would like to know the subject index, it can be extracted easily as <code>includedSubjects(counterSubject)</code>. Personally, since these variables are used very often for indexing, I tend to abbreviate the index and counter names (along with the subject indicator) to reduce the character count, even though syntactically this is not ideal, as <code>ind</code> and <code>cnt</code>, respectively, leading to <code>indSubj</code> and <code>cntSubj</code>.

              <p>
              Returning to the code example above and applying the changes:
              <pre class="prettyprint lang-matlab" style="center-align">includedSubjects = [1 3 7]; % subject IDs
nSubjects = length(includedSubjects);

correlateTimeSeriesIndividuals = nan(128, 128, nSubjects); % collect time-series correlations
for cntSubj = 1:nSubjects
    dataFile{cntSubj, 1} = sprintf('S%i_DataFile.mat', includedSubjects(cntSubj)); % subject specific data-file
    correlatedTimeSeriesIndividuals(:, :, cntSubj) = CorrelateTimeSeries(dataFile{cntSubj, 1});
    % ...
    save(sprintf('%s_CorrTimeSeries.mat', dataFile{cntSubj, 1}(1:end-4)), 'correlatedTimeSeriesIndividuals');
end

% NaN will remain in correlatedTimeSeriesIndividuals if entries are not all filled,
% or corrcoef() inside CorrelateTimeSeries() threw NaNs. In either case, computations
% should be halted, as NaNs are not handled.
if sum(isnan(correlateTimeSeriesIndividuals(:)) ~= 0)
    throw(MException('SubjectAnalysis:CorrelatedTimeSeriesIndividualsContainsNaN', ...
      'Variable "correlatedTimeSeriesIndividuals" contains %i NaN', ...
      sum(isnan(correlateTimeSeriesIndividuals(:)) ~= 0)));
end</pre></p>
              <br>

              - Further Content Upcoming -




        </div> <!-- main -->
      </div>

    </div>
  </div>


  <footer class="page-footer">
    <div class="container">

        <div class="col l12 s12 center">

          <a href="http://github.com/nielsdisbergen" target="_blank">
            <i class="fa fa-github" style="font-size:48px;color:black"></i>
          </a>

          <a href="http://www.linkedin.com/in/nielsdisbergen" target="_blank">
            <i class="fa fa-linkedin-square" style="font-size:48px;color:black"></i>
          </a>

          <a href="http://www.maastrichtuniversity.nl/niels.disbergen" target="_blank">
            <i class="fa fa-user" style="font-size:48px;color:black"></i>
          </a>

        </div>

      </div>
    </div>
    <div class="footer-copyright center">
      <div class="container">
      Niels Disbergen &#169 2017 - All Rights Reserved - Hosted on <a class="white-text" href="https://pages.github.com/" target="blank"> Github Pages</a> and built with <a class="white-text" href="http://materializecss.com" target="blank"> Materialize </a>
      </div>
    </div>
  </footer>


  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="../../js/materialize.js"></script>
  <script src="../../js/init.js"></script>
  <script type="text/javascript" src="../../js/prettify/prettify.js"></script>

  </body>
</html>
